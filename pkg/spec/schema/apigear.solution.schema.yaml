$schema: "http://json-schema.org/draft-07/schema#"
title: "ApiGear Solution 1.0 Schema"
type: object
additionalProperties: false
required:
  - schema
properties:
  schema:
    type: string
    description: "The ApiGear solution specification version of this document."
    enum: ["apigear.solution/1.0"]
    default: "apigear.solution/1.0"
  name:
    type: string
    description: "The name of the solution."
  version:
    type: string
    description: "The version of the solution. Should be a major and minor and an optional patch version, separated by a dot (e.g. 0.1 or 0.1.0)."
    pattern: "^[0-9]+[.][0-9]+([.][0-9]+)*$"
    default: "0.1.0"
  description:
    type: string
    description: "The description of the solution. It should be a short, descriptive text about the solution."
  rootDir:
    type: string
    description: "The root directory of the solution to map all other paths to. Defaults to the current working directory."
  meta:
    type: object
    description: "The meta section contains meta data about the solution, as key-value pairs."
  layers:
    type: array
    items:
      $ref: "#/definitions/Target"
    description: "The layers section contains a list of targets which are used to generate the solution."
    deprecated: true
  targets:
    type: array
    items:
      $ref: "#/definitions/Target"
    description: "The targets section contains a list of code generation targets. A target could be c++ and another target could be python"
definitions:
  Target:
    type: object
    required:
      - inputs
      - output
      - template
    additionalProperties: false
    description: "The target defines a target which is used to generate source code."
    properties:
      name:
        type: string
        description: "Name of the target, for development purposes."
      description:
        type: string
        description: "Description of the target."
      inputs:
        type: array
        items:
          type: string
        description: "List of input files which are used to generate the target (either API YAML definitions or IDL definition files)."
        default: []
      output:
        type: string
        description: "The output directory of the target."
      imports:
        type: array
        items:
          type: string
        description: "List of imports which are used to enhance the meta information."
        default: []
      meta:
        type: object
        description: "Meta data about the target which will be passed on to the template."
      template:
        type: string
        description: "Path to the template which can be either template package name (e.g. apigear-io/template-cpp) or a template folder with a rules document (../<template_folder>)."
      features:
        type: array
        items:
          type: string
        description: "A template features, which can be enabled. See the template documentation for available features."
        default: []
      dryRun:
        type: boolean
        description: "If true the target will not be generated, only the actions will be printed."
      force:
        type: boolean
        description: "If true the target will be generated even if it already exists."
